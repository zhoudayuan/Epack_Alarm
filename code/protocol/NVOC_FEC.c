#include  <stdio.h>
#include  <stdlib.h>
#include  <string.h>

typedef unsigned short   UINT16;                  /* 无符号16位整型变量                       */
typedef          short   INT16;                   /* 有符号16位整型变量                       */
typedef long             INT32;
typedef unsigned long    UINT32;

typedef unsigned char    UINT8;
typedef signed char      INT8;

//NVOC解码FEC用Golay(24,12)校验数组
static unsigned short Arr24_dsp_NVOC[4096] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2336,0,0,0,0,0,0,0,16,0,
0,0,192,0,514,1028,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1088,0,0,0,0,0,0,0,260,0,0,0,32,0,514,2192,0,0,0,0,0,0,0,0,129,0,0,0,20,0,514,8,0,0,
0,0,3080,0,514,96,0,0,514,257,0,514,514,0,514,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1088,0,0,0,0,0,0,0,16,0,0,0,2054,0,384,544,0,0,0,0,0,0,0,0,
16,0,0,0,520,0,5,130,0,0,0,0,16,0,16,16,16,0,1056,257,0,2120,0,0,16,0,0,0,0,0,0,0,1088,0,0,0,1088,0,1088,1088,1088,0,0,0,640,0,2081,10,
0,0,24,257,0,4,0,0,1088,0,0,0,34,0,264,2564,0,0,2176,257,0,48,0,0,1088,0,68,257,0,1152,0,0,16,257,0,257,257,0,514,257,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,18,0,0,0,0,0,0,0,260,0,0,0,192,0,3072,544,0,0,0,0,0,0,0,0,1536,0,0,0,192,0,5,8,0,0,0,0,192,0,40,2051,0,0,192,192,192,272,
0,0,192,0,0,0,0,0,0,0,260,0,0,0,2561,0,160,8,0,0,0,0,260,0,260,260,260,0,24,1026,0,65,0,0,260,0,0,0,34,0,2128,8,0,0,1280,8,0,8,0,8,8,0,
1,528,0,1152,0,0,260,2084,0,0,192,0,514,8,0,0,0,0,0,0,0,0,2184,0,0,0,256,0,5,544,0,0,0,0,1025,0,66,544,0,0,24,544,0,544,0,544,544,0,0,0,
34,0,5,320,0,0,5,3088,0,5,5,0,5,0,2816,12,0,1152,0,0,16,2,0,0,192,0,5,544,0,0,0,0,34,0,512,17,0,0,24,132,0,2306,0,0,1088,0,24,2112,0,
1152,0,0,260,24,24,0,24,0,24,544,0,0,34,34,34,1152,0,0,34,576,0,0,34,0,5,8,0,1152,0,0,34,1152,1152,1152,0,0,24,257,0,1152,0,0,2048,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,9,0,0,0,9,0,9,9,9,0,0,0,0,0,0,0,1536,0,0,0,20,0,64,130,0,0,0,0,258,0,2180,96,0,0,1056,2560,0,
272,0,0,9,0,0,0,0,0,0,0,2050,0,0,0,20,0,160,768,0,0,0,0,640,0,1040,96,0,0,2368,1026,0,4,0,0,9,0,0,0,20,0,264,96,0,0,20,20,20,3073,0,0,
20,0,1,96,0,96,0,96,96,136,0,0,20,0,514,96,0,0,0,0,0,0,0,0,36,0,0,0,256,0,2576,130,0,0,0,0,640,0,66,3328,0,0,1056,80,0,4,0,0,9,0,0,0,
2113,0,264,130,0,0,1056,130,0,130,0,130,130,0,1056,12,0,513,0,0,16,1056,1056,0,1056,0,1056,130,0,0,0,0,640,0,264,17,0,0,3,2088,0,4,0,0,
1088,0,640,640,640,4,0,0,640,4,0,0,640,4,4,4,0,0,264,1024,0,264,264,0,264,576,0,0,20,0,264,130,0,2066,0,0,640,0,264,96,0,0,1056,257,0,4,
0,0,2048,0,0,0,0,0,0,0,1536,0,0,0,256,0,160,2116,0,0,0,0,2096,0,66,128,0,0,516,1026,0,272,0,0,9,0,0,0,1536,0,1536,1536,1536,0,2058,33,0,
272,0,0,1536,0,1,12,0,272,0,0,1536,272,0,0,192,272,272,272,0,0,0,0,72,0,160,17,0,0,160,1026,0,160,160,0,160,0,1,1026,0,2568,0,0,260,
1026,0,1026,1026,0,160,1026,0,0,1,2432,0,6,0,0,1536,576,0,0,20,0,160,8,0,1,1,0,1,0,1,96,0,0,1,1026,0,272,0,0,2048,0,0,0,256,0,66,17,0,0,
256,256,256,1032,0,0,256,0,66,12,0,66,66,0,66,2177,0,0,256,0,66,544,0,0,144,12,0,2080,0,0,1536,576,0,0,256,0,5,130,0,12,0,12,12,0,66,12,
0,0,1056,12,0,272,0,0,2048,0,3076,17,0,17,0,17,17,576,0,0,256,0,160,17,0,288,0,0,640,0,66,17,0,0,24,1026,0,4,0,0,2048,576,0,0,34,0,264,
17,0,576,576,576,0,576,0,0,2048,0,1,12,0,1152,0,0,2048,576,0,0,2048,0,2048,2048,2048,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,0,0,0,0,
2624,0,0,0,32,0,384,1028,0,0,0,0,0,0,0,0,129,0,0,0,520,0,64,1028,0,0,0,0,258,0,40,1028,0,0,2065,1028,0,1028,0,1028,1028,0,0,0,0,0,0,0,
129,0,0,0,32,0,2060,768,0,0,0,0,32,0,1040,10,0,0,32,32,32,65,0,0,32,0,0,0,129,0,129,129,129,0,1280,2114,0,48,0,0,129,0,68,528,0,2304,0,
0,129,136,0,0,32,0,514,1028,0,0,0,0,0,0,0,0,36,0,0,0,520,0,384,2049,0,0,0,0,1025,0,384,10,0,0,384,80,0,384,384,0,384,0,0,0,520,0,3074,
320,0,0,520,520,520,48,0,0,520,0,68,2208,0,513,0,0,16,2,0,0,520,0,384,1028,0,0,0,0,2320,0,512,10,0,0,3,132,0,48,0,0,1088,0,68,10,0,10,0,
10,10,3584,0,0,32,0,384,10,0,0,68,1024,0,48,0,0,129,48,0,0,520,48,48,48,0,68,68,0,68,0,68,10,0,0,68,257,0,48,0,0,2048,0,0,0,0,0,0,0,18,
0,0,0,18,0,18,18,18,0,0,0,1025,0,40,128,0,0,516,2312,0,65,0,0,18,0,0,0,2052,0,40,320,0,0,1280,33,0,2688,0,0,18,0,40,528,0,40,40,0,40,2,
0,0,192,0,40,1028,0,0,0,0,72,0,512,3104,0,0,1280,132,0,65,0,0,18,0,2178,528,0,65,0,0,260,65,0,0,32,65,65,65,0,0,1280,528,0,6,0,0,129,
1280,1280,0,1280,0,1280,8,0,528,0,528,528,0,40,528,0,0,1280,528,0,65,0,0,2048,0,0,0,1025,0,512,320,0,0,2144,132,0,1032,0,0,18,0,1025,
1025,1025,2068,0,0,1025,2,0,0,1025,0,384,544,0,0,144,320,0,320,0,320,320,2,0,0,520,0,5,320,0,2,0,0,1025,0,40,320,0,2,2,2,0,2,0,0,2048,0,
512,132,0,512,512,0,512,132,0,132,132,0,512,132,0,288,0,0,1025,0,512,10,0,0,24,132,0,65,0,0,2048,2057,0,0,34,0,512,320,0,0,1280,132,0,
48,0,0,2048,0,68,528,0,1152,0,0,2048,2,0,0,2048,0,2048,2048,2048,0,0,0,0,0,0,0,36,0,0,0,3200,0,64,768,0,0,0,0,258,0,1040,128,0,0,516,80,
0,2082,0,0,9,0,0,0,258,0,64,2072,0,0,64,33,0,64,64,0,64,0,258,258,258,513,0,0,258,136,0,0,258,0,64,1028,0,0,0,0,72,0,1040,768,0,0,3,768,
0,768,0,768,768,0,1040,2053,0,1040,1040,0,1040,136,0,0,32,0,1040,768,0,0,2592,1024,0,6,0,0,129,136,0,0,20,0,64,768,0,136,0,0,258,0,1040,
96,0,136,136,136,0,136,0,0,2048,0,0,0,36,0,36,36,36,0,3,80,0,1032,0,0,36,0,2056,80,0,513,0,0,36,80,0,80,80,0,384,80,0,0,144,1024,0,513,
0,0,36,2308,0,0,520,0,64,130,0,513,0,0,258,513,513,513,0,0,1056,80,0,513,0,0,2048,0,3,1024,0,2240,0,0,36,3,3,0,3,0,3,768,0,288,0,0,640,
0,1040,10,0,0,3,80,0,4,0,0,2048,1024,0,1024,1024,0,264,1024,0,0,3,1024,0,48,0,0,2048,0,68,1024,0,513,0,0,2048,136,0,0,2048,0,2048,2048,
2048,0,0,0,72,0,2305,128,0,0,516,33,0,1032,0,0,18,0,516,128,0,128,0,128,128,516,516,0,516,0,516,128,0,0,144,33,0,6,0,0,1536,33,0,33,33,
0,64,33,0,3136,0,0,258,0,40,128,0,0,516,33,0,272,0,0,2048,0,72,72,72,6,0,0,72,2064,0,0,72,0,160,768,0,288,0,0,72,0,1040,128,0,0,516,
1026,0,65,0,0,2048,6,0,0,72,6,6,6,0,0,1280,33,0,6,0,0,2048,0,1,528,0,6,0,0,2048,136,0,0,2048,0,2048,2048,2048,0,144,2562,0,1032,0,0,36,
1032,0,0,256,1032,1032,1032,0,288,0,0,1025,0,66,128,0,0,516,80,0,1032,0,0,2048,144,144,0,144,0,144,320,0,0,144,33,0,1032,0,0,2048,0,144,
12,0,513,0,0,2048,2,0,0,2048,0,2048,2048,2048,288,0,0,72,0,512,17,0,0,3,132,0,1032,0,0,2048,288,288,288,0,288,0,0,2048,288,0,0,2048,0,
2048,2048,2048,0,144,1024,0,6,0,0,2048,576,0,0,2048,0,2048,2048,2048,288,0,0,2048,0,2048,2048,2048,0,2048,2048,2048,2048,2048,2048,2048,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,644,0,0,0,0,0,0,0,16,0,0,0,32,0,3072,322,0,0,0,0,0,0,0,0,16,0,0,0,1027,0,64,8,0,0,0,0,16,0,16,16,16,0,268,
2560,0,161,0,0,16,0,0,0,0,0,0,0,2050,0,0,0,32,0,273,8,0,0,0,0,32,0,200,1537,0,0,32,32,32,4,0,0,32,0,0,0,832,0,1060,8,0,0,2176,8,0,8,0,8,
8,0,1,134,0,2304,0,0,16,1104,0,0,32,0,514,8,0,0,0,0,0,0,0,0,16,0,0,0,256,0,42,2049,0,0,0,0,16,0,16,16,16,0,577,1160,0,4,0,0,16,0,0,0,16,
0,16,16,16,0,2176,100,0,1792,0,0,16,0,16,16,16,16,16,16,16,2,0,0,16,0,16,16,16,0,0,0,13,0,512,416,0,0,2176,530,0,4,0,0,1088,0,1282,2112,
0,4,0,0,16,4,0,0,32,4,4,4,0,0,2176,1024,0,67,0,0,16,2176,2176,0,2176,0,2176,8,0,552,0,0,16,0,16,16,16,0,2176,257,0,4,0,0,16,0,0,0,0,0,0,
0,97,0,0,0,256,0,3072,8,0,0,0,0,522,0,3072,128,0,0,3072,21,0,3072,3072,0,3072,0,0,0,2052,0,386,8,0,0,560,8,0,8,0,8,8,0,1,1312,0,580,0,0,
16,2,0,0,192,0,3072,8,0,0,0,0,1168,0,512,8,0,0,70,8,0,8,0,8,8,0,1,2112,0,50,0,0,260,896,0,0,32,0,3072,8,0,0,1,8,0,8,0,8,8,8,0,8,8,8,8,8,
8,1,1,0,1,0,1,8,0,0,1,8,0,8,0,8,8,0,0,0,256,0,512,1030,0,0,256,256,256,208,0,0,256,0,164,2112,0,265,0,0,16,2,0,0,256,0,3072,544,0,0,
1096,641,0,2080,0,0,16,2,0,0,256,0,5,8,0,2,0,0,16,0,16,16,16,2,2,2,0,2,0,0,16,0,512,2112,0,512,512,0,512,1057,0,0,256,0,512,8,0,2112,0,
2112,2112,0,512,2112,0,0,24,2112,0,4,0,0,131,276,0,0,34,0,512,8,0,0,2176,8,0,8,0,8,8,0,1,2112,0,1152,0,0,16,2,0,0,1540,0,352,8,0,0,0,0,
0,0,0,0,2050,0,0,0,256,0,64,1072,0,0,0,0,1092,0,800,128,0,0,146,2560,0,4,0,0,9,0,0,0,168,0,64,261,0,0,64,2560,0,64,64,0,64,0,1,2560,0,
1034,0,0,16,2560,0,2560,2560,0,64,2560,0,0,0,0,2050,0,2050,2050,2050,0,1544,193,0,4,0,0,2050,0,1,280,0,4,0,0,2050,4,0,0,32,4,4,4,0,0,1,
1024,0,656,0,0,2050,290,0,0,20,0,64,8,0,1,1,0,1,0,1,96,0,0,1,2560,0,4,0,0,1408,0,0,0,256,0,1153,584,0,0,256,256,256,4,0,0,256,0,2056,35,
0,4,0,0,16,4,0,0,256,4,4,4,0,0,518,1024,0,2080,0,0,16,25,0,0,256,0,64,130,0,448,0,0,16,0,16,16,16,0,1056,2560,0,4,0,0,16,0,112,1024,0,4,
0,0,2050,4,0,0,256,4,4,4,0,4,0,0,640,4,4,4,0,4,4,4,0,4,4,4,4,1024,0,1024,1024,0,264,1024,0,0,2176,1024,0,4,0,0,545,0,1,1024,0,4,0,0,16,
4,0,0,74,4,4,4,0,0,0,0,256,0,28,128,0,0,256,256,256,515,0,0,256,0,1,128,0,128,0,128,128,104,0,0,256,0,3072,128,0,0,1,82,0,2080,0,0,1536,
1156,0,0,256,0,64,8,0,1,1,0,1,0,1,128,0,0,1,2560,0,272,0,0,38,0,1,548,0,1344,0,0,2050,2064,0,0,256,0,160,8,0,1,1,0,1,0,1,128,0,0,1,1026,
0,4,0,0,592,1,1,0,1,0,1,8,0,0,1,8,0,8,0,8,8,1,1,1,1,1,1,0,1,1,1,0,1,0,1,8,0,0,256,256,256,2080,0,0,256,256,256,256,256,0,256,256,256,
1552,0,0,256,0,66,128,0,0,256,256,256,4,0,0,256,2080,0,0,256,2080,2080,2080,0,0,256,256,256,2080,0,0,256,0,1,12,0,2080,0,0,16,2,0,0,256,
0,648,1089,0,138,0,0,256,0,512,17,0,0,256,256,256,4,0,0,256,0,1,2112,0,4,0,0,1064,4,0,0,256,4,4,4,0,0,1,1024,0,2080,0,0,196,576,0,0,256,
0,1042,8,0,1,1,0,1,0,1,770,0,0,1,176,0,4,0,0,2048,0,0,0,0,0,0,0,1288,0,0,0,32,0,64,2049,0,0,0,0,32,0,7,128,0,0,32,32,32,536,0,0,32,0,0,
0,2052,0,64,546,0,0,64,400,0,64,64,0,64,0,1664,73,0,2304,0,0,16,2,0,0,32,0,64,1028,0,0,0,0,32,0,512,84,0,0,32,32,32,1154,0,0,32,0,32,32,
32,2304,0,0,32,32,32,32,32,0,32,32,32,0,26,1024,0,2304,0,0,129,517,0,0,32,0,64,8,0,2304,0,0,32,2304,2304,2304,0,0,32,32,32,2304,0,0,32,
0,0,0,194,0,512,2049,0,0,1044,2049,0,2049,0,2049,2049,0,2056,772,0,1120,0,0,16,2,0,0,32,0,384,2049,0,0,289,1024,0,140,0,0,16,2,0,0,520,
0,64,2049,0,2,0,0,16,0,16,16,16,2,2,2,0,2,0,0,16,0,512,1024,0,512,512,0,512,328,0,0,32,0,512,2049,0,145,0,0,32,0,512,10,0,0,32,32,32,4,
0,0,32,1024,0,1024,1024,0,512,1024,0,0,2176,1024,0,48,0,0,262,0,68,1024,0,2304,0,0,16,2,0,0,32,0,1033,704,0,0,0,0,2052,0,512,128,0,0,
137,1600,0,292,0,0,18,0,336,128,0,128,0,128,128,2,0,0,32,0,3072,128,0,0,2052,2052,2052,1041,0,0,2052,2,0,0,2052,0,64,8,0,2,0,0,2052,0,
40,128,0,2,2,2,0,2,0,0,769,0,512,259,0,512,512,0,512,2064,0,0,32,0,512,8,0,1036,0,0,32,0,512,128,0,0,32,32,32,65,0,0,32,224,0,0,2052,0,
512,8,0,0,1280,8,0,8,0,8,8,0,1,528,0,2304,0,0,1090,2,0,0,32,0,148,8,0,0,512,56,0,512,512,0,512,2,0,0,256,0,512,2049,0,2,0,0,1025,0,512,
128,0,2,2,2,0,2,0,0,76,2,0,0,2052,0,512,320,0,2,2,2,0,2,0,0,1184,2,2,2,0,2,0,0,16,2,2,2,2,2,2,2,0,512,512,0,512,512,512,512,512,0,512,
132,0,512,512,0,512,0,512,2112,0,512,512,0,512,2,0,0,32,0,512,1296,0,0,512,1024,0,512,512,0,512,2,0,0,81,0,512,8,0,2,0,0,392,0,512,37,0,
2,2,2,0,2,0,0,2048,0,0,0,529,0,64,128,0,0,64,14,0,64,64,0,64,0,2056,128,0,128,0,128,128,1281,0,0,32,0,64,128,0,0,64,1024,0,64,64,0,64,
64,64,0,64,64,64,64,64,52,0,0,258,0,64,128,0,0,64,2560,0,64,64,0,64,0,388,1024,0,41,0,0,2050,2064,0,0,32,0,64,768,0,578,0,0,32,0,1040,
128,0,0,32,32,32,4,0,0,32,1024,0,1024,1024,0,64,1024,0,0,64,1024,0,64,64,0,64,0,1,1024,0,2304,0,0,524,136,0,0,32,0,64,19,0,0,2056,1024,
0,274,0,0,36,672,0,0,256,0,64,2049,0,2056,2056,0,2056,0,2056,128,0,0,2056,80,0,4,0,0,1538,1024,0,1024,1024,0,64,1024,0,0,64,1024,0,64,
64,0,64,0,2056,1024,0,513,0,0,16,2,0,0,133,0,64,296,0,1024,0,1024,1024,0,512,1024,0,0,3,1024,0,4,0,0,152,0,2056,1024,0,4,0,0,321,4,0,0,
32,4,4,4,0,1024,1024,1024,1024,1024,0,1024,1024,1024,0,1024,1024,0,64,1024,0,1024,0,1024,1024,0,162,1024,0,0,784,1024,0,4,0,0,2048,0,
1058,128,0,128,0,128,128,2064,0,0,256,0,64,128,0,128,0,128,128,128,128,128,128,0,516,128,0,128,0,128,128,776,0,0,2052,0,64,128,0,0,64,
33,0,64,64,0,64,0,1,128,0,128,0,128,128,2,0,0,1048,0,64,128,0,2064,0,0,72,0,512,128,0,2064,2064,2064,0,2064,0,0,1029,0,1,128,0,128,0,
128,128,2064,0,0,32,0,266,128,0,0,1,1024,0,6,0,0,304,2064,0,0,642,0,64,8,0,1,1,0,1,0,1,128,0,0,1,324,0,1568,0,0,2048,69,0,0,256,0,512,
128,0,0,256,256,256,1032,0,0,256,0,2056,128,0,128,0,128,128,2,0,0,256,0,49,128,0,0,144,1024,0,2080,0,0,11,2,0,0,256,0,64,532,0,2,0,0,
608,0,1284,128,0,2,2,2,0,2,0,0,2048,0,512,1024,0,512,512,0,512,2064,0,0,256,0,512,98,0,288,0,0,22,0,512,128,0,0,1216,521,0,4,0,0,2048,
1024,0,1024,1024,0,512,1024,0,0,44,1024,0,385,0,0,2048,0,1,1024,0,88,0,0,2048,2,0,0,2048,0,2048,2048,2048};



/**
 * @brief   将short型数组展开成bit流，高bit开始
 * @param [in]   puWords    
 * @param [in]   uWordNum
 * @param [out]  puBits  
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static void NVOC_vConvertWord2Bit(UINT16 *puBits, UINT16 *puWords, UINT16 uWordNum)
{
    UINT16 i = 0;
    UINT16 j = 0;
    UINT16 uDataTemp = 0;

    for(i=0;i<uWordNum;i++)
    {
        uDataTemp = 0x8000;
        for(j=0;j<16;j++)
        {
            if(0 != (uDataTemp & (*(puWords+i))))
            {
                *(puBits+i*16+j) = 0x0001;
            }
            else
            {
                *(puBits+i*16+j) = 0x0000;
            }
            uDataTemp = uDataTemp >> 1;
        }
    }
}

/**
 * @brief   将bit流合并成short型数组，从高bit开始
 * @param [in]   puBits    
 * @param [in]   uBitNum
 * @param [out]  puWords  
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static void NVOC_vConvertBit2Word(UINT16 *puWords, UINT16 *puBits, UINT16 uBitNum)
{
	UINT16 i = 0;
	UINT16 j = 0;
	UINT16 uDataTemp = 0x8000; 
    UINT16 aa = 0;
    UINT16 bb = 0;

    aa = uBitNum/16;
    bb = uBitNum%16;

	for(i=0;i<aa;i++)
	{
		for(j=0;j<16;j++)
		{
			if(0x0000 != *(puBits + 16*i+j))
			{	
				*(puWords + i) = *(puWords + i) | uDataTemp;
			}
			else
			{
				*(puWords + i) = *(puWords + i) & (~uDataTemp);
			
			}
			uDataTemp = uDataTemp >> 1;
		}	
		uDataTemp = 0x8000;
	}

    uDataTemp = 0x8000;
    
    for(i=0;i<bb;i++)
    {
        if(0x0000 != *(puBits + 16*aa+i))
        {
            *(puWords + aa) =  *(puWords + aa) | uDataTemp;
        }
        else
        {
            *(puWords + aa) = *(puWords + aa) & (~uDataTemp);
        }
    	uDataTemp = uDataTemp >> 1;
    }
}




/**
 * @brief   将long型展开成bit流
 * @param [in]   puInput    
 * @param [in]   uBitNum
 * @param [out]  *puBits  
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static void NVOC_vConvertLong2Bit(UINT32 puInput, UINT16 *puBits, UINT16 uBitNum)
{
	UINT16 i = 0;
	UINT32 uDataTemp = 0;

	if (uBitNum > 32)
	{
		printf("[NVOC_vConvertLong2Bit]uBitNum too long!\n");
		return;
	}

	uDataTemp = puInput;
	for (i = 0; i < uBitNum; i++)
	{
		if ((uDataTemp & 0x1) == 0)
		{
			puBits[uBitNum -1 - i] = 0;
		}
		else
		{
			puBits[uBitNum -1 - i] = 1;
		}
		uDataTemp = uDataTemp >> 1;
	}
}



/**
 * @brief   bit流合并成long型数据
 * @param [in]   puBits    
 * @param [in]   uBitNum   最大32
 * @retuen  合并结果 
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static UINT32 NVOC_u4ConvertBit2Long(UINT16 *puBits, UINT16 uBitNum)
{
	UINT16 i = 0;
	UINT32 uDataTemp = 0;

	if (uBitNum > 32)
	{
		printf("[vConvertBit2Long]uBitNum too long!\n");
		return 0;
	}

	uDataTemp = 0;
	
	for (i = 0; i<uBitNum; i++)
	{
		uDataTemp = uDataTemp << 1;
		if (puBits[i] == 0)
		{
			uDataTemp = uDataTemp & 0xFFFFFFFE;
		}
		else
		{
			uDataTemp = uDataTemp | 0x00000001;
		}		
	}

	return uDataTemp;
}


/**
 * @brief   Golay(24,12)编码
 * @param [in]   u4Data    编码源，低12bit有效
 * @return  编码结果，低24bit有效 
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static UINT32 NVOC_u4Golay_24_12_enc_nvoc(UINT32 u4Data)
{
	UINT16  u2Res = 0;
	UINT16  u2Cnt = 0;
	UINT32  u4Cal = u4Data;

	static const short s_au2Gl24MtxG[12] =
	{
		0x07FF, 0x0EE2, 0x0DC5, 0x0B8B, 0x0F16, 0x0E2D,
		0x0C5B, 0x08B7, 0x096E, 0x0ADC, 0x0DB8, 0x0B71
	};

	for (u2Cnt = 0; u2Cnt < 12; u2Cnt++)
	{
		u2Res = u4Data & s_au2Gl24MtxG[u2Cnt];
		u2Res ^= u2Res >> 8;
		u2Res ^= u2Res >> 4;
		u2Res ^= u2Res >> 2;
		u2Res ^= u2Res >> 1;

		u4Cal = (u4Cal << 1) | (u2Res & 0x01);
	}

	return (u4Cal & 0x0ffffff);
}

/**
 * @brief   Golay(24,12)解码
 * @param [in]   u4Data    解码源，低24bit有效
 * @return  编码结果，低12bit有效 
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static UINT32 NVOC_u4Golay_24_12_dec_nvoc(UINT32 u4Data)
{
	UINT32 u4Res        = 0;
	UINT16 u2Idx        = 0;
	UINT16 u2Cnt        = 0;
	static const UINT32 s_au4Gl24MtxH[12] =
	{
		0x07FF800, 0x0EE2400, 0x0DC5200, 0x0B8B100, 0x0F16080, 0x0E2D040,
		0x0C5B020, 0x08B7010, 0x096E008, 0x0ADC004, 0x0DB8002, 0x0B71001
	};

	for (u2Cnt = 0; u2Cnt < 12; u2Cnt++)
	{
		u4Res  = u4Data & s_au4Gl24MtxH[u2Cnt];
		u4Res ^= u4Res >> 16;
		u4Res ^= u4Res >> 8;
		u4Res ^= u4Res >> 4;
		u4Res ^= u4Res >> 2;
		u4Res ^= u4Res >> 1;

		u2Idx  = (u2Idx << 1) | (u4Res & 0x01);
	}

	u4Data = (u4Data >> 12)^ Arr24_dsp_NVOC[u2Idx];


	return (u4Data & 0xfff);
}




/**
 * @brief   交织函数
 * @param [in]     SrcBitBuf
 * @param [out]   SrcBitBuf 
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static void NVOC_vInterleave(UINT16 *SrcBitBuf, UINT16 *DstBitBuf)
{
	UINT16 i,j;
	UINT16 TmpBuf[72] = {0};
	for(i=0;i<8;i++)
	{
		for(j=0;j<9;j++)
		{
			TmpBuf[j*8+i] = SrcBitBuf[i*9+j];
		}	
	}
	for(i=0;i<9;i++)
	{
		DstBitBuf[i*8+0] = TmpBuf[i*8+4];
		DstBitBuf[i*8+1] = TmpBuf[i*8+0];
		DstBitBuf[i*8+2] = TmpBuf[i*8+5];
		DstBitBuf[i*8+3] = TmpBuf[i*8+1];
		DstBitBuf[i*8+4] = TmpBuf[i*8+6];
		DstBitBuf[i*8+5] = TmpBuf[i*8+2];
		DstBitBuf[i*8+6] = TmpBuf[i*8+7];
		DstBitBuf[i*8+7] = TmpBuf[i*8+3];
	}
}


/**
 * @brief   解交织函数
 * @param [in]     SrcBitBuf
 * @param [out]   SrcBitBuf 
 * @author  张超
 * @since   fec1.0
 * @bug
 */
static void NVOC_vUnInterleave(UINT16 *SrcBitBuf, UINT16 *DstBitBuf)
{
	UINT16 i,j;
	UINT16 TmpBuf[72] = {0};

	for(i=0;i<9;i++)
	{
		TmpBuf[i*8+4] = SrcBitBuf[i*8+0];
		TmpBuf[i*8+0] = SrcBitBuf[i*8+1];
		TmpBuf[i*8+5] = SrcBitBuf[i*8+2];
		TmpBuf[i*8+1] = SrcBitBuf[i*8+3];
		TmpBuf[i*8+6] = SrcBitBuf[i*8+4];
		TmpBuf[i*8+2] = SrcBitBuf[i*8+5];
		TmpBuf[i*8+7] = SrcBitBuf[i*8+6];
		TmpBuf[i*8+3] = SrcBitBuf[i*8+7];
	}


	for(i=0;i<8;i++)
	{
		for(j=0;j<9;j++)
		{
			DstBitBuf[i*9+j] = TmpBuf[j*8+i];
		}	
	}
}




void NVOC_FecEncFun(UINT16 *SrcWordBuf, UINT16 *DstBitBuf)
{
	UINT16 SrcBitBuf[72] = {0};
	UINT16 TmpBitBuf[72] = {0};
	UINT16 Tmp12 = 0;			//Golay数据源
	UINT32 Tmp24 = 0;			//Golay数据结果
	UINT16 i;

	NVOC_vConvertWord2Bit(SrcBitBuf, SrcWordBuf, 3);

	//取第一个12bit(1-12)
	Tmp12 = (SrcWordBuf[0] >> 3) & 0x0FFF;

	Tmp24 = NVOC_u4Golay_24_12_enc_nvoc(Tmp12);

	NVOC_vConvertLong2Bit(Tmp24, TmpBitBuf, 24);
	//取第2个12bit(37、24、25、26、40、30、31、32、33、34、35、36)
	Tmp12 = 0;
	Tmp12 = (Tmp12 | SrcBitBuf[37])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[24])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[25])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[26])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[40])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[30])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[31])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[32])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[33])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[34])<<1;
	Tmp12 = (Tmp12 | SrcBitBuf[35])<<1;
	Tmp12 =  Tmp12 | SrcBitBuf[36];

	Tmp24 = NVOC_u4Golay_24_12_enc_nvoc(Tmp12);

	NVOC_vConvertLong2Bit(Tmp24, &TmpBitBuf[24], 24);
	//填充其余24bit：13、14、15、16、17、18、19、20、21、22、23、0、41、42、43、44、45、46、47、27、28、29、38、39
	for(i=0;i<11;i++)
	{
		TmpBitBuf[48+i] = SrcBitBuf[13+i];
	}
	TmpBitBuf[59] = SrcBitBuf[0];
	for(i=0;i<7;i++)
	{
		TmpBitBuf[60+i] = SrcBitBuf[41+i];
	}
	TmpBitBuf[67] = SrcBitBuf[27];
	TmpBitBuf[68] = SrcBitBuf[28];
	TmpBitBuf[69] = SrcBitBuf[29];
	TmpBitBuf[70] = SrcBitBuf[38];
	TmpBitBuf[71] = SrcBitBuf[39];
	//交织
	NVOC_vInterleave(TmpBitBuf, DstBitBuf);


}


void NVOC_FecDecFun(UINT16 *SrcBitBuf, UINT16 *DstWordBuf)
{
	UINT16 TmpBitBuf[72] = {0};
	UINT16 DstBitBuf[72] = {0};
	UINT16 Tmp32Bit[32] = {0};
	UINT16 Tmp12 = 0;			//Golay解码数据结果
	UINT32 Tmp24 = 0;			//Golay解码数据源
	UINT16 i;

	//解交织
	NVOC_vUnInterleave(SrcBitBuf,TmpBitBuf);

	//取未编码数据
	for(i=0;i<11;i++)
	{
		DstBitBuf[13+i] = TmpBitBuf[48+i];
	}
	DstBitBuf[0] = TmpBitBuf[59];
	for(i=0;i<7;i++)
	{
		DstBitBuf[41+i] = TmpBitBuf[60+i];
	}
	DstBitBuf[27] = TmpBitBuf[67];
	DstBitBuf[28] = TmpBitBuf[68];
	DstBitBuf[29] = TmpBitBuf[69];
	DstBitBuf[38] = TmpBitBuf[70];
 	DstBitBuf[39] = TmpBitBuf[71];

	//解码第2个12bit
	Tmp24 = NVOC_u4ConvertBit2Long(&TmpBitBuf[24],24);

	Tmp12 = NVOC_u4Golay_24_12_dec_nvoc(Tmp24);

	NVOC_vConvertLong2Bit(Tmp12, Tmp32Bit, 12);

	DstBitBuf[37] = Tmp32Bit[0];
	DstBitBuf[24] = Tmp32Bit[1];
	DstBitBuf[25] = Tmp32Bit[2];
	DstBitBuf[26] = Tmp32Bit[3];
	DstBitBuf[40] = Tmp32Bit[4];
	for(i=0;i<7;i++)
	{
		DstBitBuf[30+i] = Tmp32Bit[5+i];
	}

	//解码第1个12bit
	Tmp24 = NVOC_u4ConvertBit2Long(TmpBitBuf,24);

	Tmp12 = NVOC_u4Golay_24_12_dec_nvoc(Tmp24);

	NVOC_vConvertLong2Bit(Tmp12, Tmp32Bit, 12);

	for(i=0;i<12;i++)
	{
		DstBitBuf[1+i] = Tmp32Bit[i];
	}

	//组48bit结果
	NVOC_vConvertBit2Word(DstWordBuf,DstBitBuf,48);


}











